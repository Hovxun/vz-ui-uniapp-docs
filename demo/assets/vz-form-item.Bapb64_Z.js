import{d as e,N as r,m as t,r as s,J as n,L as i,R as a,T as l,o,c as u,w as d,p as f,u as c,n as p,v as g,b as m,e as h,t as y,q as v,f as b,l as q}from"./index-BWsgb0Z6.js";import{c as F}from"./bem.DA8SpLb8.js";import{a as $}from"./unit.BrsgufDc.js";import{d as w,b as x,n as A,g as O,a as j}from"./utils.nWkN1vD-.js";import{F as E,a as P}from"./constants.Dht7B1D0.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";const _=/%[sdj%]/g;let R=()=>{};function C(e){if(!e||!e.length)return null;const r={};return e.forEach((e=>{const t=e.field;r[t]=r[t]||[],r[t].push(e)})),r}function V(e,...r){let t=0;const s=r.length;if("function"==typeof e)return e.apply(null,r);if("string"==typeof e){return e.replace(_,(e=>{if("%%"===e)return"%";if(t>=s)return e;switch(e){case"%s":return String(r[t++]);case"%d":return Number(r[t++]);case"%j":try{return JSON.stringify(r[t++])}catch(n){return"[Circular]"}break;default:return e}}))}return e}function D(e,r){return null==e||(!("array"!==r||!Array.isArray(e)||e.length)||!(!function(e){return"string"===e||"url"===e||"hex"===e||"email"===e||"date"===e||"pattern"===e}(r)||"string"!=typeof e||e))}function T(e,r,t){let s=0;const n=e.length;!function i(a){if(a&&a.length)return void t(a);const l=s;s+=1,l<n?r(e[l],i):t([])}([])}class z extends Error{constructor(e,r){super("Async Validation Error"),this.errors=e,this.fields=r}}function N(e,r,t,s,n){if(r.first){const r=new Promise(((r,i)=>{const a=function(e){const r=[];return Object.keys(e).forEach((t=>{r.push(...e[t]||[])})),r}(e);T(a,t,(e=>(s(e),e.length?i(new z(e,C(e))):r(n))))}));return r.catch((e=>e)),r}const i=!0===r.firstFields?Object.keys(e):r.firstFields||[],a=Object.keys(e),l=a.length;let o=0;const u=[],d=new Promise(((r,d)=>{const f=e=>{if(u.push.apply(u,e),o++,o===l)return s(u),u.length?d(new z(u,C(u))):r(n)};a.length||(s(u),r(n)),a.forEach((r=>{const s=e[r];-1!==i.indexOf(r)?T(s,t,f):function(e,r,t){const s=[];let n=0;const i=e.length;function a(e){s.push(...e||[]),n++,n===i&&t(s)}e.forEach((e=>{r(e,a)}))}(s,t,f)}))}));return d.catch((e=>e)),d}function S(e,r){return t=>{let s;return s=e.fullFields?function(e,r){let t=e;for(let s=0;s<r.length;s++){if(null==t)return t;t=t[r[s]]}return t}(r,e.fullFields):r[t.field||e.fullField],(n=t)&&void 0!==n.message?(t.field=t.field||e.fullField,t.fieldValue=s,t):{message:"function"==typeof t?t():t,fieldValue:s,field:t.field||e.fullField};var n}}function B(e,r){if(r)for(const t in r)if(r.hasOwnProperty(t)){const s=r[t];"object"==typeof s&&"object"==typeof e[t]?e[t]={...e[t],...s}:e[t]=s}return e}const I=(e,r,t,s,n,i)=>{!e.required||t.hasOwnProperty(e.field)&&!D(r,i||e.type)||s.push(V(n.messages.required,e.fullField))};let J;const M=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,W=/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i,Z={integer:e=>Z.number(e)&&parseInt(e,10)===e,float:e=>Z.number(e)&&!Z.integer(e),array:e=>Array.isArray(e),regexp(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch(r){return!1}},date:e=>"function"==typeof e.getTime&&"function"==typeof e.getMonth&&"function"==typeof e.getYear&&!isNaN(e.getTime()),number:e=>!isNaN(e)&&"number"==typeof e,object:e=>"object"==typeof e&&!Z.array(e),method:e=>"function"==typeof e,email:e=>"string"==typeof e&&e.length<=320&&!!e.match(M),url:e=>"string"==typeof e&&e.length<=2048&&!!e.match((()=>{if(J)return J;const e="[a-fA-F\\d:]",r=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${e})|(?<=${e})(?=\\s|$))`:"",t="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",n=`\n(?:\n(?:${s}:){7}(?:${s}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${s}:){6}(?:${t}|:${s}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${s}:){5}(?::${t}|(?::${s}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${s}:){4}(?:(?::${s}){0,1}:${t}|(?::${s}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${s}:){3}(?:(?::${s}){0,2}:${t}|(?::${s}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${s}:){2}(?:(?::${s}){0,3}:${t}|(?::${s}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${s}:){1}(?:(?::${s}){0,4}:${t}|(?::${s}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${s}){0,5}:${t}|(?::${s}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),i=new RegExp(`(?:^${t}$)|(?:^${n}$)`),a=new RegExp(`^${t}$`),l=new RegExp(`^${n}$`),o=e=>e&&e.exact?i:new RegExp(`(?:${r(e)}${t}${r(e)})|(?:${r(e)}${n}${r(e)})`,"g");o.v4=e=>e&&e.exact?a:new RegExp(`${r(e)}${t}${r(e)}`,"g"),o.v6=e=>e&&e.exact?l:new RegExp(`${r(e)}${n}${r(e)}`,"g");const u=o.v4().source,d=o.v6().source;return J=new RegExp(`(?:^(?:(?:(?:[a-z]+:)?//)|www\\.)(?:\\S+(?::\\S*)?@)?(?:localhost|${u}|${d}|(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#][^\\s"]*)?$)`,"i"),J})()),hex:e=>"string"==typeof e&&!!e.match(W)},H={required:I,whitespace:(e,r,t,s,n)=>{(/^\s+$/.test(r)||""===r)&&s.push(V(n.messages.whitespace,e.fullField))},type:(e,r,t,s,n)=>{if(e.required&&void 0===r)return void I(e,r,t,s,n);const i=e.type;["integer","float","array","regexp","object","method","email","number","date","url","hex"].indexOf(i)>-1?Z[i](r)||s.push(V(n.messages.types[i],e.fullField,e.type)):i&&typeof r!==e.type&&s.push(V(n.messages.types[i],e.fullField,e.type))},range:(e,r,t,s,n)=>{const i="number"==typeof e.len,a="number"==typeof e.min,l="number"==typeof e.max,o=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;let u=r,d=null;const f="number"==typeof r,c="string"==typeof r,p=Array.isArray(r);if(f?d="number":c?d="string":p&&(d="array"),!d)return!1;p&&(u=r.length),c&&(u=r.replace(o,"_").length),i?u!==e.len&&s.push(V(n.messages[d].len,e.fullField,e.len)):a&&!l&&u<e.min?s.push(V(n.messages[d].min,e.fullField,e.min)):l&&!a&&u>e.max?s.push(V(n.messages[d].max,e.fullField,e.max)):a&&l&&(u<e.min||u>e.max)&&s.push(V(n.messages[d].range,e.fullField,e.min,e.max))},enum:(e,r,t,s,n)=>{e.enum=Array.isArray(e.enum)?e.enum:[],-1===e.enum.indexOf(r)&&s.push(V(n.messages.enum,e.fullField,e.enum.join(", ")))},pattern:(e,r,t,s,n)=>{if(e.pattern)if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(r)||s.push(V(n.messages.pattern.mismatch,e.fullField,r,e.pattern));else if("string"==typeof e.pattern){new RegExp(e.pattern).test(r)||s.push(V(n.messages.pattern.mismatch,e.fullField,r,e.pattern))}}},L=(e,r,t,s,n)=>{const i=e.type,a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(D(r,i)&&!e.required)return t();H.required(e,r,s,a,n,i),D(r,i)||H.type(e,r,s,a,n)}t(a)},U={string:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(D(r,"string")&&!e.required)return t();H.required(e,r,s,i,n,"string"),D(r,"string")||(H.type(e,r,s,i,n),H.range(e,r,s,i,n),H.pattern(e,r,s,i,n),!0===e.whitespace&&H.whitespace(e,r,s,i,n))}t(i)},method:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(D(r)&&!e.required)return t();H.required(e,r,s,i,n),void 0!==r&&H.type(e,r,s,i,n)}t(i)},number:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(""===r&&(r=void 0),D(r)&&!e.required)return t();H.required(e,r,s,i,n),void 0!==r&&(H.type(e,r,s,i,n),H.range(e,r,s,i,n))}t(i)},boolean:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(D(r)&&!e.required)return t();H.required(e,r,s,i,n),void 0!==r&&H.type(e,r,s,i,n)}t(i)},regexp:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(D(r)&&!e.required)return t();H.required(e,r,s,i,n),D(r)||H.type(e,r,s,i,n)}t(i)},integer:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(D(r)&&!e.required)return t();H.required(e,r,s,i,n),void 0!==r&&(H.type(e,r,s,i,n),H.range(e,r,s,i,n))}t(i)},float:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(D(r)&&!e.required)return t();H.required(e,r,s,i,n),void 0!==r&&(H.type(e,r,s,i,n),H.range(e,r,s,i,n))}t(i)},array:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(null==r&&!e.required)return t();H.required(e,r,s,i,n,"array"),null!=r&&(H.type(e,r,s,i,n),H.range(e,r,s,i,n))}t(i)},object:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(D(r)&&!e.required)return t();H.required(e,r,s,i,n),void 0!==r&&H.type(e,r,s,i,n)}t(i)},enum:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(D(r)&&!e.required)return t();H.required(e,r,s,i,n),void 0!==r&&H.enum(e,r,s,i,n)}t(i)},pattern:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(D(r,"string")&&!e.required)return t();H.required(e,r,s,i,n),D(r,"string")||H.pattern(e,r,s,i,n)}t(i)},date:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(D(r,"date")&&!e.required)return t();if(H.required(e,r,s,i,n),!D(r,"date")){let t;t=r instanceof Date?r:new Date(r),H.type(e,t,s,i,n),t&&H.range(e,t.getTime(),s,i,n)}}t(i)},url:L,hex:L,email:L,required:(e,r,t,s,n)=>{const i=[],a=Array.isArray(r)?"array":typeof r;H.required(e,r,s,i,n,a),t(i)},any:(e,r,t,s,n)=>{const i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(D(r)&&!e.required)return t();H.required(e,r,s,i,n)}t(i)}};function Y(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone(){const e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}const G=Y(),K=class e{constructor(e){this.rules=null,this._messages=G,this.define(e)}define(e){if(!e)throw new Error("Cannot configure a schema with no rules");if("object"!=typeof e||Array.isArray(e))throw new Error("Rules must be an object");this.rules={},Object.keys(e).forEach((r=>{const t=e[r];this.rules[r]=Array.isArray(t)?t:[t]}))}messages(e){return e&&(this._messages=B(Y(),e)),this._messages}validate(r,t={},s=(()=>{})){let n=r,i=t,a=s;if("function"==typeof i&&(a=i,i={}),!this.rules||0===Object.keys(this.rules).length)return a&&a(null,n),Promise.resolve(n);if(i.messages){let e=this.messages();e===G&&(e=Y()),B(e,i.messages),i.messages=e}else i.messages=this.messages();const l={};(i.keys||Object.keys(this.rules)).forEach((e=>{const t=this.rules[e];let s=n[e];t.forEach((t=>{let i=t;"function"==typeof i.transform&&(n===r&&(n={...n}),s=n[e]=i.transform(s)),i="function"==typeof i?{validator:i}:{...i},i.validator=this.getValidationMethod(i),i.validator&&(i.field=e,i.fullField=i.fullField||e,i.type=this.getType(i),l[e]=l[e]||[],l[e].push({rule:i,value:s,source:n,field:e}))}))}));const o={};return N(l,i,((r,t)=>{var s;const a=r.rule;let l,u=!("object"!==a.type&&"array"!==a.type||"object"!=typeof a.fields&&"object"!=typeof a.defaultField);function d(e,r){return{...r,fullField:`${a.fullField}.${e}`,fullFields:a.fullFields?[...a.fullFields,e]:[e]}}function f(s=[]){let l=Array.isArray(s)?s:[s];!i.suppressWarning&&l.length&&e.warning("async-validator:",l),l.length&&void 0!==a.message&&(l=[].concat(a.message));let f=l.map(S(a,n));if(i.first&&f.length)return o[a.field]=1,t(f);if(u){if(a.required&&!r.value)return void 0!==a.message?f=[].concat(a.message).map(S(a,n)):i.error&&(f=[i.error(a,V(i.messages.required,a.field))]),t(f);let s={};a.defaultField&&Object.keys(r.value).map((e=>{s[e]=a.defaultField})),s={...s,...r.rule.fields};const l={};Object.keys(s).forEach((e=>{const r=s[e],t=Array.isArray(r)?r:[r];l[e]=t.map(d.bind(null,e))}));const o=new e(l);o.messages(i.messages),r.rule.options&&(r.rule.options.messages=i.messages,r.rule.options.error=i.error),o.validate(r.value,r.rule.options||i,(e=>{const r=[];f&&f.length&&r.push(...f),e&&e.length&&r.push(...e),t(r.length?r:null)}))}else t(f)}if(u=u&&(a.required||!a.required&&r.value),a.field=r.field,a.asyncValidator)l=a.asyncValidator(a,r.value,f,r.source,i);else if(a.validator){try{l=a.validator(a,r.value,f,r.source,i)}catch(c){null==(s=console.error)||s.call(console,c),i.suppressValidatorError||setTimeout((()=>{throw c}),0),f(c.message)}!0===l?f():!1===l?f("function"==typeof a.message?a.message(a.fullField||a.field):a.message||`${a.fullField||a.field} fails`):l instanceof Array?f(l):l instanceof Error&&f(l.message)}l&&l.then&&l.then((()=>f()),(e=>f(e)))}),(e=>{!function(e){let r=[],t={};for(let n=0;n<e.length;n++)s=e[n],Array.isArray(s)?r=r.concat(...s):r.push(s);var s;r.length?(t=C(r),a(r,t)):a(null,n)}(e)}),n)}getType(e){if(void 0===e.type&&e.pattern instanceof RegExp&&(e.type="pattern"),"function"!=typeof e.validator&&e.type&&!U.hasOwnProperty(e.type))throw new Error(V("Unknown rule type %s",e.type));return e.type||"string"}getValidationMethod(e){if("function"==typeof e.validator)return e.validator;const r=Object.keys(e),t=r.indexOf("message");return-1!==t&&r.splice(t,1),1===r.length&&"required"===r[0]?U.required:U[this.getType(e)]||void 0}};K.register=function(e,r){if("function"!=typeof r)throw new Error("Cannot register a validator by type, validator is not a function");U[e]=r},K.warning=R,K.messages=G,K.validators=U;let Q=K;const X=k(e({name:"VZFormItem",__name:"vz-form-item",props:{prop:{},rules:{},label:{},labelWidth:{},labelPosition:{},labelAlign:{},labelColor:{},required:{type:Boolean,default:!1},border:{type:Boolean,default:!0},iClass:{},iStyle:{}},setup(e,{expose:k}){const _=r(E,void 0),R=e,C=F("form-item"),V=t((()=>C.cssVarBlock({"label-width":$(R.labelWidth||(null==_?void 0:_.labelWidth)||""),"label-color":R.labelColor||(null==_?void 0:_.labelColor)}))),D=t((()=>R.labelPosition?"top"===R.labelPosition:"top"===(null==_?void 0:_.labelPosition))),T=s(""),z=s("");let N,S=!1;const B=t((()=>{const e=null==_?void 0:_.model;if(e&&R.prop)return O(e,R.prop)})),I=t((()=>{const e=[];R.rules&&e.push(...j(R.rules));const r=null==_?void 0:_.rules;if(r&&R.prop){const t=O(r,R.prop);t&&e.push(...j(t))}return e})),J=t((()=>I.value.some((e=>e.required))));function M(){R.prop,null==_||_.model}const W=async(e,r)=>{if(S)return!1;if(!R.prop||!(null==_?void 0:_.model))return M(),null==r||r(!1),!1;const t=function(e){return I.value.filter((r=>!r.trigger||!e||(Array.isArray(r.trigger)?r.trigger.includes(e):r.trigger===e)))}(e);if(!t.length)return null==r||r(!0),!0;return new Q({[R.prop]:t}).validate({[R.prop]:B.value},{firstFields:!0}).then((()=>(T.value="success",z.value="",null==r||r(!0),!0))).catch((e=>{const{errors:t,fields:s}=e;return function(e){T.value="error",z.value=e[0].message||"","toast"===(null==_?void 0:_.messageType)&&z.value&&q({icon:"none",title:z.value})}(t),null==r||r(!1,{errors:t,fields:s}),!r&&Promise.reject({errors:t,fields:s})}))},Z=()=>{T.value="",z.value=""},H=async()=>{R.prop&&(null==_?void 0:_.model)?(S=!0,x(null==_?void 0:_.model,R.prop,w(N)),await A(),Z(),S=!1):M()},L=n({prop:R.prop,validate:W,clearValidate:Z,resetField:H});return i(P,L),a((()=>{R.prop&&(null==_||_.addChild(L),N=w(B.value))})),l((()=>{null==_||_.removeChild(L)})),k({validateState:T,validateMessage:z,validate:W,clearValidate:Z,resetField:H}),(e,r)=>{var t,s;const n=b;return o(),u(n,{class:f([c(C).b(),c(C).m(null==(t=c(_))?void 0:t.messageType),c(C).is("vertical",D.value),c(C).is("border",e.border),c(C).is("feedback",null==(s=c(_))?void 0:s.borderFeedback),c(C).is("error","error"===T.value),e.iClass]),style:v([V.value,e.iStyle])},{default:d((()=>{var r,t,s,i,a;return[e.label||e.$slots.label?(o(),u(n,{key:0,class:f([c(C).e("label"),c(C).em("label",e.labelAlign||(null==(r=c(_))?void 0:r.labelAlign)),c(C).is("required",!(null==(t=c(_))?void 0:t.requiredHide)&&(e.required||J.value)),c(C).is("required-holder",!(null==(s=c(_))?void 0:s.requiredHide)&&(null==(i=c(_))?void 0:i.requiredHolder)),"right"===(null==(a=c(_))?void 0:a.requiredPosition)?"is-required-right":"is-required-left"])},{default:d((()=>[p(e.$slots,"label",{},(()=>[h(y(e.label),1)]),!0)])),_:3},8,["class"])):g("",!0),m(n,{class:f(c(C).e("content"))},{default:d((()=>{var r;return[p(e.$slots,"default",{},void 0,!0),"undertext"===(null==(r=c(_))?void 0:r.messageType)?(o(),u(n,{key:0,class:f(c(C).e("error"))},{default:d((()=>[h(y(z.value),1)])),_:1},8,["class"])):g("",!0)]})),_:3},8,["class"])]})),_:3},8,["class","style"])}}}),[["__scopeId","data-v-37ec092f"]]);export{X as _};
